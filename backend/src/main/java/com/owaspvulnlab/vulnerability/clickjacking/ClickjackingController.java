package com.owaspvulnlab.vulnerability.clickjacking;

import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/clickjacking")
@CrossOrigin(origins = "*")
public class ClickjackingController {

    @GetMapping("/vulnerable")
    public ResponseEntity<String> vulnerable() {
        String html = "<html><body><h3>转账按钮(可被嵌入)</h3>" +
                "<form method='POST' action='/api/csrf/transfer'>" +
                "<input name='to' value='attacker'/>" +
                "<input name='amount' value='100'/>" +
                "<button type='submit'>转账</button>" +
                "</form></body></html>";
        return ResponseEntity.ok().contentType(MediaType.TEXT_HTML).body(html);
    }

    @GetMapping("/safe")
    public ResponseEntity<String> safe() {
        String html = "<html><body><h3>受保护页面</h3></body></html>";
        return ResponseEntity.ok()
                .header("X-Frame-Options", "DENY")
                .contentType(MediaType.TEXT_HTML)
                .body(html);
    }
}
